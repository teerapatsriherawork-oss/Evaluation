{
  "version": 3,
  "sources": ["../../vuetify/src/components/VDialog/VDialog.tsx"],
  "sourcesContent": ["// Styles\nimport './VDialog.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VOverlay } from '@/components/VOverlay'\nimport { makeVOverlayProps } from '@/components/VOverlay/VOverlay'\n\n// Composables\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useScopeId } from '@/composables/scopeId'\n\n// Utilities\nimport { mergeProps, nextTick, onBeforeUnmount, ref, watch } from 'vue'\nimport { focusableChildren, genericComponent, IN_BROWSER, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { OverlaySlots } from '@/components/VOverlay/VOverlay'\n\nexport const makeVDialogProps = propsFactory({\n  fullscreen: Boolean,\n  retainFocus: {\n    type: Boolean,\n    default: true,\n  },\n  scrollable: Boolean,\n\n  ...makeVOverlayProps({\n    origin: 'center center' as const,\n    scrollStrategy: 'block' as const,\n    transition: { component: VDialogTransition },\n    zIndex: 2400,\n  }),\n}, 'VDialog')\n\nexport const VDialog = genericComponent<OverlaySlots>()({\n  name: 'VDialog',\n\n  props: makeVDialogProps(),\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n    afterEnter: () => true,\n    afterLeave: () => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const isActive = useProxiedModel(props, 'modelValue')\n    const { scopeId } = useScopeId()\n\n    const overlay = ref<VOverlay>()\n    async function onFocusin (e: FocusEvent) {\n      const before = e.relatedTarget as HTMLElement | null\n      const after = e.target as HTMLElement | null\n\n      await nextTick()\n\n      if (\n        isActive.value &&\n        before !== after &&\n        overlay.value?.contentEl &&\n        // We're the topmost dialog\n        overlay.value?.globalTop &&\n        // It isn't the document or the dialog body\n        ![document, overlay.value.contentEl].includes(after!) &&\n        // It isn't inside the dialog body\n        !overlay.value.contentEl.contains(after)\n      ) {\n        const focusable = focusableChildren(overlay.value.contentEl)\n        focusable[0]?.focus()\n      }\n    }\n\n    function onKeydown (e: KeyboardEvent) {\n      if (e.key !== 'Tab' || !overlay.value?.contentEl) return\n\n      const focusable = focusableChildren(overlay.value.contentEl)\n      if (!focusable.length) return\n\n      const firstElement = focusable[0]\n      const lastElement = focusable[focusable.length - 1]\n      const active = document.activeElement as HTMLElement | null\n\n      if (e.shiftKey && active === firstElement) {\n        e.preventDefault()\n        lastElement.focus()\n      } else if (!e.shiftKey && active === lastElement) {\n        e.preventDefault()\n        firstElement.focus()\n      }\n    }\n\n    onBeforeUnmount(() => {\n      document.removeEventListener('focusin', onFocusin)\n      document.removeEventListener('keydown', onKeydown)\n    })\n\n    if (IN_BROWSER) {\n      watch(() => isActive.value && props.retainFocus, val => {\n        if (val) {\n          document.addEventListener('focusin', onFocusin, { once: true })\n          document.addEventListener('keydown', onKeydown)\n        } else {\n          document.removeEventListener('focusin', onFocusin)\n          document.removeEventListener('keydown', onKeydown)\n        }\n      }, { immediate: true })\n    }\n\n    function onAfterEnter () {\n      emit('afterEnter')\n      if (\n        (props.scrim || props.retainFocus) &&\n        overlay.value?.contentEl &&\n        !overlay.value.contentEl.contains(document.activeElement)\n      ) {\n        overlay.value.contentEl.focus({ preventScroll: true })\n      }\n    }\n\n    function onAfterLeave () {\n      emit('afterLeave')\n    }\n\n    watch(isActive, async val => {\n      if (!val) {\n        await nextTick()\n        overlay.value!.activatorEl?.focus({ preventScroll: true })\n      }\n    })\n\n    useRender(() => {\n      const overlayProps = VOverlay.filterProps(props)\n      const activatorProps = mergeProps({\n        'aria-haspopup': 'dialog',\n      }, props.activatorProps)\n      const contentProps = mergeProps({\n        tabindex: -1,\n      }, props.contentProps)\n\n      return (\n        <VOverlay\n          ref={ overlay }\n          class={[\n            'v-dialog',\n            {\n              'v-dialog--fullscreen': props.fullscreen,\n              'v-dialog--scrollable': props.scrollable,\n            },\n            props.class,\n          ]}\n          style={ props.style }\n          { ...overlayProps }\n          v-model={ isActive.value }\n          aria-modal=\"true\"\n          activatorProps={ activatorProps }\n          contentProps={ contentProps }\n          height={ !props.fullscreen ? props.height : undefined }\n          width={ !props.fullscreen ? props.width : undefined }\n          maxHeight={ !props.fullscreen ? props.maxHeight : undefined }\n          maxWidth={ !props.fullscreen ? props.maxWidth : undefined }\n          role=\"dialog\"\n          onAfterEnter={ onAfterEnter }\n          onAfterLeave={ onAfterLeave }\n          { ...scopeId }\n        >\n          {{\n            activator: slots.activator,\n            default: (...args) => (\n              <VDefaultsProvider root=\"VDialog\">\n                { slots.default?.(...args) }\n              </VDefaultsProvider>\n            ),\n          }}\n        </VOverlay>\n      )\n    })\n\n    return forwardRefs({}, overlay)\n  },\n})\n\nexport type VDialog = InstanceType<typeof VDialog>\n"],
  "mappings": "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",
  "names": ["makeVDialogProps", "propsFactory", "fullscreen", "Boolean", "retainFocus", "type", "default", "scrollable", "makeVOverlayProps", "origin", "scrollStrategy", "transition", "component", "VDialogTransition", "zIndex", "VDialog", "genericComponent", "name", "props", "emits", "value", "afterEnter", "afterLeave", "setup", "_ref", "emit", "slots", "isActive", "useProxiedModel", "scopeId", "useScopeId", "overlay", "ref", "onFocusin", "e", "before", "relatedTarget", "after", "target", "nextTick", "contentEl", "globalTop", "document", "includes", "contains", "focusable", "focusableChildren", "focus", "onKeydown", "key", "length", "firstElement", "lastElement", "active", "activeElement", "shiftKey", "preventDefault", "onBeforeUnmount", "removeEventListener", "IN_BROWSER", "watch", "val", "addEventListener", "once", "immediate", "onAfterEnter", "scrim", "preventScroll", "onAfterLeave", "activatorEl", "useRender", "overlayProps", "VOverlay", "filterProps", "activatorProps", "mergeProps", "contentProps", "tabindex", "_createVNode", "_mergeProps", "class", "style", "$event", "height", "undefined", "width", "maxHeight", "maxWidth", "activator", "_len", "arguments", "args", "Array", "_key", "VDefaultsProvider", "forwardRefs"]
}
